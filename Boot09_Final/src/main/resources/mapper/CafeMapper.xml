<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cafe">

<insert id="insert" parameterType="cafeDto">
	INSERT INTO board_cafe
	(num,writer,title,content,viewCount,regdate)
	VALUES(board_cafe_seq.NEXTVAL,#{writer},#{title},#{content},#{viewCount},SYSDATE)
</insert>

<delete id="delete" parameterType="int">
	DELETE FROM board_cafe
	WHERE num=#{num}
</delete>

<update id="update" parameterType="cafeDto">
	UPDATE board_cafe
	SET title=#{title},content=#{content},viewCount=#{viewCount}
	WHERE num=#{num}
</update>

<select id="getData" parameterType="int" resultType="cafeDto">
	SELECT num,writer,title,content,viewCount,regdate
	FROM board_cafe
	WHERE num=#{num}
</select>

<!-- 
	파라미터로 전달된 dto의 필드명 혹은 Map 객체의 key 값과 일치하도록 하면 자동 바인딩 된다.
 -->	
<select id="getList" parameterType="cafeDto" resultType="cafeDto">
	SELECT *
	FROM
		(SELECT result1.*,ROWNUM AS rnum
		FROM
			(SELECT num,writer,title,viewCount, TO_CHAR(regdate, 'YYYY.MM.DD HH24:MI') AS regdate
			FROM board_cafe
			ORDER BY num DESC)result1)
	WHERE rnum BETWEEN #{startRowNum} AND #{endRowNum}		
</select>

<select id="getCount" resultType="int">
	SELECT MAX(ROWNUM)
	FROM board_cafe
</select>

</mapper>

